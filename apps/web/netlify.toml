# Netlify config for the Next.js frontend (apps/web)
[build]
# Use apps/web as the base directory so Netlify builds the frontend workspace
  base = "apps/web"
  # Use the repository root custom build script to ensure identity build + prisma generation
  # From apps/web the repo root is two levels up
  command = "chmod +x ../../netlify-build.sh && ../../netlify-build.sh"
  publish = ".next"
  # Environment variables
  [build.environment]
    # Primary API base used by the frontend (points at the Netlify identity backend)
    NEXT_PUBLIC_API_BASE_URL = "https://amoravibe-identity.netlify.app/api/v1"
    # Legacy/auxiliary trust API setting (kept for compatibility)
    NEXT_PUBLIC_TRUST_API_URL = "https://amoravibe-identity.netlify.app/api/v1"

[functions]
  directory = "../../services/identity"

[[plugins]]
  package = "@netlify/plugin-nextjs"
