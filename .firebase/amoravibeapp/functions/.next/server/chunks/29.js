exports.id=29,exports.ids=[29],exports.modules={85825:(e,t,a)=>{Promise.resolve().then(a.bind(a,20069)),Promise.resolve().then(a.bind(a,38207))},62542:(e,t,a)=>{Promise.resolve().then(a.t.bind(a,24424,23)),Promise.resolve().then(a.t.bind(a,37752,23)),Promise.resolve().then(a.t.bind(a,75275,23)),Promise.resolve().then(a.t.bind(a,29842,23)),Promise.resolve().then(a.t.bind(a,1633,23)),Promise.resolve().then(a.t.bind(a,9224,23))},20069:(e,t,a)=>{"use strict";let r;a.d(t,{OnboardingModalProvider:()=>J,V:()=>Q});var l=a(73227),s=a(23677),i=a(41043),o=a(66655),n=a(94725),c=a(77587),d=a(41749),u=a(64651),p=a(52970),m=a(56942),x=a(98985),h=a(40401),g=a(4211),y=a(98813),b=a(34666),f=a(58619),v=a(10405),j=a(83534),w=a(23925),N=a(19294);let C=(0,s.createContext)(void 0);function P({children:e}){let[t,a]=(0,s.useState)(null),[r,i]=(0,s.useState)(!1);return l.jsx(C.Provider,{value:{data:t,saveOnboarding:e=>{try{localStorage.setItem("lovedate_onboarding",JSON.stringify(e)),a(e),i(!0)}catch(e){console.error("Failed to save onboarding data:",e)}},clearOnboarding:()=>{try{localStorage.removeItem("lovedate_onboarding"),a(null),i(!1)}catch(e){console.error("Failed to clear onboarding data:",e)}},isOnboarded:r},children:e})}let k=(0,a(87870).MI)({baseUrl:!(r=(process.env.TRUST_API_PROXY_TARGET||"https://api-amoravibe.vercel.app").replace(/\/$/,""))||r.startsWith("http://")||r.startsWith("https://")||r.startsWith("/")?r:`https://${r}`,apiKey:process.env.TRUST_API_KEY}),S=["Travel","Fitness","Music","Movies","Cooking","Art","Reading","Gaming","Sports","Photography","Dancing","Yoga"],M=[{label:"Woman",value:"woman"},{label:"Man",value:"man"},{label:"Non-binary",value:"non_binary"},{label:"Trans woman",value:"trans_woman"},{label:"Trans man",value:"trans_man"},{label:"Self describe",value:"self_describe"}],O=[{label:"Heterosexual",value:"heterosexual"},{label:"Gay",value:"gay"},{label:"Lesbian",value:"lesbian"},{label:"Bisexual",value:"bisexual"},{label:"Pansexual",value:"pansexual"},{label:"Asexual",value:"asexual"},{label:"Queer",value:"queer"}],E=[{label:"Straight space",value:"straight",helper:"Strictly heterosexual trust lane."},{label:"LGBTQ+ space",value:"lgbtq",helper:"Queer-forward spotlighting."},{label:"Dual space",value:"both",helper:"Blend both lanes (bi / pan / queer)."}],I=[{label:"Women",value:"women",helper:"Appear to women-curated spaces."},{label:"Men",value:"men",helper:"Appear to men-curated spaces."},{label:"Everyone",value:"everyone",helper:"Unified pool, overrides others."}],T=[{value:"Long-term relationship",emoji:"\uD83D\uDC91"},{value:"Short-term relationship",emoji:"\uD83D\uDC9D"},{value:"Friendship",emoji:"\uD83E\uDD1D"},{value:"Casual dating",emoji:"☕"},{value:"Not sure yet",emoji:"\uD83E\uDD14"}],A=e=>{let[t,a]=e.center??e.geometry?.coordinates??[0,0],r=e.context??[],l=r.find(e=>e.id.startsWith("country")),s=r.find(e=>e.id.startsWith("region")),i=e.text??e.place_name;return{id:e.id,label:i,secondaryLabel:e.place_name,fullLabel:e.place_name,lat:a,lng:t,country:l?.text??null,countryCode:l?.short_code??e.properties?.short_code??null,region:s?.text??null,regionCode:s?.short_code??null,timezone:e.properties?.timezone??null}},D={firstName:"",lastName:"",displayName:"",dateOfBirth:"",email:"",phone:"",password:"",gender:"",orientation:"",orientationPreferences:[],discoverySpace:"",matchPreferences:[],lookingFor:"",interests:[],city:"",cityPlaceId:null,cityCountry:null,cityCountryCode:null,cityRegion:null,cityRegionCode:null,cityTimezone:null,cityLat:null,cityLng:null,locationAccuracyMeters:null,locationUpdatedAt:null,bio:"",photos:["",""],verificationIntent:"verify_now"},L=e=>{let t=e.indexOf(",");return Math.ceil(3*(t>=0?e.slice(t+1):e).length/4)},R=async e=>{let t=await new Promise((t,a)=>{let r=new FileReader;r.onload=()=>t(r.result),r.onerror=()=>a(r.error??Error("Unable to read photo file.")),r.readAsDataURL(e)});return e.size,t},_=async e=>{try{let t=await new Promise((t,a)=>{let r=new Image;r.onload=()=>t(r),r.onerror=()=>a(Error("Failed to load image data for compression.")),r.src=e}),a=Math.max(t.width,t.height),r=a>1280?1280/a:1,l=(e,a)=>{let r=document.createElement("canvas");r.width=Math.max(1,Math.round(t.width*e)),r.height=Math.max(1,Math.round(t.height*e));let l=r.getContext("2d");return l?(l.drawImage(t,0,0,r.width,r.height),r.toDataURL("image/jpeg",a)):null},s=[.72,.6,.5,.4,.3],i=[r,.9*r,.8*r,.7*r];for(let e of i)for(let t of s){let a=l(e,t);if(a&&460800>=L(a))return a}return l(i[i.length-1],s[s.length-1])??e}catch(t){return console.warn("compressDataUrl failed",t),e}};function U({isOpen:e,onClose:t}){let[a,r]=(0,s.useState)(0),[x,h]=(0,s.useState)(D),[g,y]=(0,s.useState)(!1),[b,f]=(0,s.useState)(null),[v,j]=(0,s.useState)(null),w=(0,i.useRouter)(),N=(e,t)=>{h(a=>({...a,[e]:t}))},P=(0,s.useCallback)(e=>{h(t=>({...t,...e}))},[]),S=e=>{h(t=>({...t,interests:t.interests.includes(e)?t.interests.filter(t=>t!==e):[...t.interests,e]}))},M=e=>{h(t=>{let a=t.orientationPreferences.includes(e);return{...t,orientationPreferences:a?t.orientationPreferences.filter(t=>t!==e):[...t.orientationPreferences,e]}})},O=e=>{h(t=>{let a=t.matchPreferences.includes(e);if("everyone"===e)return{...t,matchPreferences:a?[]:["everyone"]};let r=t.matchPreferences.filter(e=>"everyone"!==e);return{...t,matchPreferences:a?r.filter(t=>t!==e):[...r,e]}})},E=(e,t)=>{h(a=>{let r=[...a.photos];return r[e]=t,{...a,photos:r}})},I=async(e,t)=>{if(t)try{let a=await R(t);if(L(a)>460800)throw Error("Photo still exceeds inline size budget after compression.");E(e,a)}catch(e){console.error("Unable to process uploaded photo",e),f("Please choose a smaller photo (under 450 KB) or reduce its resolution.")}},T=()=>{h(e=>({...e,photos:[...e.photos,""]}))},A=e=>{h(t=>({...t,photos:t.photos.filter((t,a)=>a!==e)}))},U=(0,s.useMemo)(()=>{switch(a){case 0:return!!(x.firstName&&x.lastName&&x.displayName&&x.dateOfBirth&&x.gender&&x.orientation);case 1:return!!((x.email||x.phone)&&x.password.length>=8);case 2:return x.orientationPreferences.length>0&&x.matchPreferences.length>0&&""!==x.discoverySpace;case 3:return!!(x.lookingFor&&x.interests.length>=3);case 4:return x.city.trim().length>0&&x.bio.trim().length>=20&&x.photos.some(e=>e.trim().length>0);case 5:return!!x.verificationIntent;default:return!0}},[a,x]),G=function(){let e=(0,s.useContext)(C);if(!e)throw Error("useOnboarding must be used within OnboardingProvider");return e}(),K=async e=>{if(e?.preventDefault(),U&&!g){y(!0),f(null);try{for(let e=0;e<x.photos.length;e++){let t=x.photos[e];if(t&&t.startsWith("data:")&&L(t)>460800)try{let a=await _(t);a&&460800>=L(a)&&E(e,a)}catch(t){console.warn("Auto-compress failed for photo index",e,t)}}if(x.photos.map((e,t)=>e&&L(e)>460800?t:-1).filter(e=>e>=0).length>0){f("One or more photos exceed the 450 KB inline size limit. Please remove or choose smaller images."),y(!1);return}let e={legalName:x.firstName,legalLastName:x.lastName||void 0,displayName:x.displayName||x.firstName,dateOfBirth:x.dateOfBirth,email:x.email||void 0,phone:x.phone||void 0,password:x.password,gender:x.gender,orientation:x.orientation,orientationPreferences:x.orientationPreferences,discoverySpace:x.discoverySpace,matchPreferences:x.matchPreferences,city:x.city,cityPlaceId:x.cityPlaceId??void 0,cityCountry:x.cityCountry??void 0,cityCountryCode:x.cityCountryCode??void 0,cityRegion:x.cityRegion??void 0,cityRegionCode:x.cityRegionCode??void 0,cityTimezone:x.cityTimezone??void 0,cityLat:x.cityLat??void 0,cityLng:x.cityLng??void 0,locationAccuracyMeters:x.locationAccuracyMeters??void 0,locationUpdatedAt:x.locationUpdatedAt??void 0,bio:x.bio||void 0,photos:x.photos.filter(e=>e.trim().length>0),verificationIntent:x.verificationIntent},a=await k.submitOnboarding(e),r=a.user.id,l=a.user.displayName;G.saveOnboarding({userId:r,displayName:l,email:x.email,gender:x.gender,orientation:x.orientation,city:x.city,bio:x.bio,photos:x.photos.filter(e=>e.trim().length>0),completedAt:Date.now()});try{if(x.email||x.phone){let e={email:x.email||void 0,phone:x.phone||void 0,password:x.password},t=await fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});t.ok||console.warn("Auto-login after onboarding failed",await t.text().catch(()=>""))}}catch(e){console.warn("Auto-login error",e)}j(`Welcome aboard, ${l}! Redirecting…`),setTimeout(()=>{j(null),t(),w.push(a.nextRoute??`/dashboard?userId=${encodeURIComponent(r)}`)},1200)}catch(e){console.error("Onboarding submit error",e),f(e instanceof Error?e.message:"Something went wrong. Please try again.")}finally{y(!1)}}};return l.jsx(o.M,{children:e&&(0,l.jsxs)(l.Fragment,{children:[l.jsx(n.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:t,className:"fixed inset-0 z-50 bg-black/60 backdrop-blur-sm"}),l.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:l.jsx("div",{className:"flex min-h-screen items-center justify-center px-4 py-8",children:(0,l.jsxs)(n.E.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",duration:.45},className:"relative w-full max-w-2xl",onClick:e=>e.stopPropagation(),children:[l.jsx("button",{onClick:t,className:"absolute -top-5 -right-5 z-10 flex h-12 w-12 items-center justify-center rounded-full bg-white shadow-xl transition hover:bg-gray-100","aria-label":"Close onboarding modal",children:l.jsx(c.Z,{className:"h-6 w-6 text-gray-600"})}),(0,l.jsxs)(n.E.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-8 text-center text-white",children:[(0,l.jsxs)("div",{className:"mb-4 flex items-center justify-center gap-2",children:[l.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-gradient-to-br from-purple-600 to-pink-600",children:l.jsx(d.Z,{className:"h-7 w-7 text-white"})}),l.jsx("span",{className:"bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-3xl font-bold text-transparent",children:"AmoraVibe"})]}),l.jsx("h2",{className:"text-3xl font-bold md:text-4xl",children:"Let’s complete your Trust Center profile"}),l.jsx("p",{className:"text-lg text-white/80",children:"Six guided steps • Safeguarded in real-time"})]}),l.jsx(Z,{currentStep:a}),(0,l.jsxs)(n.E.form,{onSubmit:K,initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"rounded-3xl bg-white p-6 shadow-2xl md:p-10",children:[l.jsx(o.M,{mode:"wait",children:(()=>{switch(a){case 0:return l.jsx(B,{data:x,onChange:N},"step-identity");case 1:return l.jsx($,{data:x,onChange:N},"step-contact");case 2:return l.jsx(z,{data:x,onChange:N,onToggleMatchPreference:O,onToggleOrientationPreference:M},"step-discovery");case 3:return l.jsx(W,{data:x,onChange:N,onToggleInterest:S},"step-intent");case 4:return l.jsx(F,{data:x,onChange:N,onBulkChange:P,onPhotoChange:E,onPhotoFileUpload:I,onAddPhoto:T,onRemovePhoto:A},"step-story");case 5:return l.jsx(V,{data:x,onChange:N},"step-verification");default:return null}})()}),b&&l.jsx("p",{className:"mt-6 rounded-2xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-700","aria-live":"polite",children:b}),v&&l.jsx("p",{className:"mt-6 rounded-2xl border border-emerald-200 bg-emerald-50 px-4 py-3 text-sm text-emerald-700","aria-live":"polite",children:v}),(0,l.jsxs)("div",{className:"mt-8 flex flex-wrap items-center gap-3",children:[a>0&&(0,l.jsxs)("button",{type:"button",onClick:()=>{r(e=>Math.max(e-1,0))},className:"flex items-center gap-2 rounded-xl border-2 border-gray-300 px-6 py-3 text-sm font-medium text-gray-700 transition hover:border-purple-600 hover:bg-purple-50",children:[l.jsx(u.Z,{className:"h-5 w-5"}),"Back"]}),a<5?(0,l.jsxs)("button",{type:"button",onClick:()=>{U&&r(e=>Math.min(e+1,5))},disabled:!U||g,className:"ml-auto flex items-center gap-2 rounded-xl bg-gradient-to-r from-purple-600 to-pink-600 px-8 py-3 text-sm font-semibold text-white transition hover:shadow-lg disabled:cursor-not-allowed disabled:opacity-50",children:["Next",l.jsx(p.Z,{className:"h-5 w-5"})]}):(0,l.jsxs)("button",{type:"submit",disabled:!U||g,className:"ml-auto flex items-center gap-2 rounded-xl bg-gradient-to-r from-purple-600 to-pink-600 px-8 py-3 text-sm font-semibold text-white transition hover:shadow-lg disabled:cursor-not-allowed disabled:opacity-50",children:[g?"Submitting…":"Create account",l.jsx(m.Z,{className:"h-5 w-5"})]})]})]})]})})})]})})}let Z=({currentStep:e})=>l.jsx("div",{className:"mb-6",children:l.jsx("div",{className:"mb-2 flex items-center justify-between",children:Array.from({length:6}).map((t,a)=>(0,l.jsxs)("div",{className:"flex flex-1 items-center",children:[l.jsx(n.E.div,{initial:!1,animate:{backgroundColor:a<=e?"rgb(147 51 234)":"rgb(229 231 235)",scale:a===e?1.15:1},className:"z-10 flex h-10 w-10 items-center justify-center rounded-full text-white font-bold",children:a<e?l.jsx(m.Z,{className:"h-5 w-5"}):a+1}),a<5&&l.jsx(n.E.div,{initial:!1,animate:{backgroundColor:a<e?"rgb(147 51 234)":"rgb(229 231 235)"},className:"mx-2 h-1 flex-1 rounded-full"})]},a))})}),B=({data:e,onChange:t})=>(0,l.jsxs)(n.E.div,{initial:{opacity:0,x:40},animate:{opacity:1,x:0},exit:{opacity:0,x:-40},transition:{duration:.25},children:[l.jsx(G,{icon:l.jsx(x.Z,{className:"h-6 w-6"}),title:"Identity basics",helper:"Legal data stays encrypted but powers high-signal matching."}),(0,l.jsxs)("div",{className:"space-y-5",children:[l.jsx(K,{label:"Legal first name",children:l.jsx("input",{type:"text",value:e.firstName,onChange:e=>t("firstName",e.target.value),className:"w-full rounded-xl border-2 border-gray-200 px-4 py-3 focus:border-purple-500 focus:outline-none",placeholder:"Ifeoluwa"})}),l.jsx(K,{label:"Legal last name",children:l.jsx("input",{type:"text",value:e.lastName,onChange:e=>t("lastName",e.target.value),className:"w-full rounded-xl border-2 border-gray-200 px-4 py-3 focus:border-purple-500 focus:outline-none",placeholder:"Adeyemi"})}),l.jsx(K,{label:"Display name",children:l.jsx("input",{type:"text",value:e.displayName,onChange:e=>t("displayName",e.target.value),className:"w-full rounded-xl border-2 border-gray-200 px-4 py-3 focus:border-purple-500 focus:outline-none",placeholder:"What should matches call you?"})}),l.jsx(K,{label:"Date of birth",children:l.jsx("input",{type:"date",value:e.dateOfBirth,onChange:e=>t("dateOfBirth",e.target.value),className:"w-full rounded-xl border-2 border-gray-200 px-4 py-3 focus:border-purple-500 focus:outline-none"})}),l.jsx(K,{label:"Gender",children:l.jsx("div",{className:"grid grid-cols-2 gap-3 sm:grid-cols-3",children:M.map(a=>l.jsx(X,{label:a.label,selected:e.gender===a.value,onClick:()=>t("gender",a.value)},a.value))})}),l.jsx(K,{label:"Orientation",children:l.jsx("div",{className:"grid grid-cols-2 gap-3 sm:grid-cols-3",children:O.map(a=>l.jsx(X,{label:a.label,selected:e.orientation===a.value,onClick:()=>t("orientation",a.value)},a.value))})})]})]},"identity"),$=({data:e,onChange:t})=>(0,l.jsxs)(n.E.div,{initial:{opacity:0,x:40},animate:{opacity:1,x:0},exit:{opacity:0,x:-40},transition:{duration:.25},children:[l.jsx(G,{icon:l.jsx(h.Z,{className:"h-6 w-6"}),title:"Contact & security",helper:"Use at least one channel so we can keep your account safe."}),(0,l.jsxs)("div",{className:"space-y-5",children:[l.jsx(K,{label:"Email address",icon:l.jsx(g.Z,{className:"h-4 w-4 text-gray-400"}),children:l.jsx("input",{type:"email",value:e.email,onChange:e=>t("email",e.target.value),className:"w-full rounded-xl border-2 border-gray-200 px-4 py-3 pl-10 focus:border-purple-500 focus:outline-none",placeholder:"you@email.com"})}),l.jsx(K,{label:"Phone number",icon:l.jsx(Y,{}),children:l.jsx("input",{type:"tel",value:e.phone,onChange:e=>t("phone",e.target.value),className:"w-full rounded-xl border-2 border-gray-200 px-4 py-3 pl-10 focus:border-purple-500 focus:outline-none",placeholder:"+1 555 123 4567"})}),l.jsx(K,{label:"Password",icon:l.jsx(y.Z,{className:"h-4 w-4 text-gray-400"}),children:l.jsx("input",{type:"password",value:e.password,onChange:e=>t("password",e.target.value),className:"w-full rounded-xl border-2 border-gray-200 px-4 py-3 pl-10 focus:border-purple-500 focus:outline-none",placeholder:"Min 8 characters"})})]})]},"contact"),z=({data:e,onChange:t,onToggleMatchPreference:a,onToggleOrientationPreference:r})=>(0,l.jsxs)(n.E.div,{initial:{opacity:0,x:40},animate:{opacity:1,x:0},exit:{opacity:0,x:-40},transition:{duration:.25},children:[l.jsx(G,{icon:l.jsx(b.Z,{className:"h-6 w-6"}),title:"Discovery preferences",helper:"We tune visibility lanes so the right people find you fast."}),(0,l.jsxs)("div",{className:"space-y-5",children:[l.jsx(K,{label:"Orientation preferences",children:l.jsx("div",{className:"flex flex-wrap gap-3",children:O.map(t=>l.jsx(X,{label:t.label,selected:e.orientationPreferences.includes(t.value),onClick:()=>r(t.value),multi:!0},t.value))})}),l.jsx(K,{label:"Visibility lanes",children:l.jsx("div",{className:"flex flex-wrap gap-3",children:I.map(t=>l.jsx(X,{label:t.label,helper:t.helper,selected:e.matchPreferences.includes(t.value),onClick:()=>a(t.value),multi:!0},t.value))})}),l.jsx(K,{label:"Discovery space",children:l.jsx("div",{className:"grid gap-4 md:grid-cols-3",children:E.map(a=>(0,l.jsxs)("button",{type:"button",onClick:()=>t("discoverySpace",a.value),className:`rounded-2xl border-2 px-4 py-4 text-left transition hover:border-purple-500 ${e.discoverySpace===a.value?"border-purple-600 bg-purple-50":"border-gray-200"}`,children:[l.jsx("p",{className:"text-base font-semibold text-gray-900",children:a.label}),l.jsx("p",{className:"text-sm text-gray-500",children:a.helper})]},a.value))})})]})]},"discovery"),W=({data:e,onChange:t,onToggleInterest:a})=>(0,l.jsxs)(n.E.div,{initial:{opacity:0,x:40},animate:{opacity:1,x:0},exit:{opacity:0,x:-40},transition:{duration:.25},children:[l.jsx(G,{icon:l.jsx(f.Z,{className:"h-6 w-6"}),title:"What are you looking for?",helper:"Signals make it easier to pair you with compatible intentions."}),(0,l.jsxs)("div",{className:"space-y-5",children:[l.jsx(K,{label:"Relationship intent",children:l.jsx("div",{className:"grid gap-3 sm:grid-cols-2",children:T.map(a=>(0,l.jsxs)("button",{type:"button",onClick:()=>t("lookingFor",a.value),className:`flex items-center gap-3 rounded-2xl border-2 px-4 py-4 text-left transition ${e.lookingFor===a.value?"border-purple-600 bg-purple-50":"border-gray-200"}`,children:[l.jsx("span",{className:"text-2xl",children:a.emoji}),l.jsx("span",{className:"text-base font-semibold text-gray-900",children:a.value})]},a.value))})}),l.jsx(K,{label:"Your interests (choose at least 3)",children:l.jsx("div",{className:"flex flex-wrap gap-2",children:S.map(t=>l.jsx(X,{label:t,selected:e.interests.includes(t),onClick:()=>a(t),multi:!0},t))})})]})]},"intent"),F=({data:e,onChange:t,onBulkChange:a,onPhotoChange:r,onPhotoFileUpload:i,onAddPhoto:o,onRemovePhoto:c})=>{let d=process.env.NEXT_PUBLIC_MAPBOX_TOKEN,[u,p]=(0,s.useState)([]),[m,x]=(0,s.useState)(!1),[h,g]=(0,s.useState)(!1),[y,b]=(0,s.useState)(null),[f,N]=(0,s.useState)(!1),C=(0,s.useRef)(!1),P=(0,s.useCallback)(()=>a({cityPlaceId:null,cityCountry:null,cityCountryCode:null,cityRegion:null,cityRegionCode:null,cityTimezone:null,cityLat:null,cityLng:null,locationAccuracyMeters:null,locationUpdatedAt:null}),[a]),k=e=>{b(null),a({city:e}),P(),x(!!e.trim().length)},S=(0,s.useCallback)((e,t)=>{C.current=!0,a({city:e.fullLabel,cityPlaceId:e.id,cityCountry:e.country??null,cityCountryCode:e.countryCode??null,cityRegion:e.region??null,cityRegionCode:e.regionCode??null,cityTimezone:e.timezone??null,cityLat:e.lat,cityLng:e.lng,locationAccuracyMeters:t??null,locationUpdatedAt:new Date().toISOString()}),p([]),x(!1)},[a]);return(0,s.useEffect)(()=>{if(!d){p([]);return}if(C.current){C.current=!1;return}let t=e.city.trim();if(t.length<2){p([]);return}let a=new AbortController;g(!0);let r=setTimeout(async()=>{try{let e=new URL(`https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURIComponent(t)}.json`);e.searchParams.set("access_token",d),e.searchParams.set("types","place,locality"),e.searchParams.set("limit","5"),e.searchParams.set("autocomplete","true");let r=await fetch(e.toString(),{signal:a.signal});if(!r.ok)throw Error("Mapbox geocoding failed");let l=await r.json();p((l.features??[]).map(A)),b(null),x(!0)}catch(e){a.signal.aborted||(console.error("Mapbox geocoding error",e),b("Unable to fetch city suggestions. Please try again."),p([]))}finally{a.signal.aborted||g(!1)}},350);return()=>{clearTimeout(r),a.abort()}},[e.city,d]),(0,l.jsxs)(n.E.div,{initial:{opacity:0,x:40},animate:{opacity:1,x:0},exit:{opacity:0,x:-40},transition:{duration:.25},children:[l.jsx(G,{icon:l.jsx(v.Z,{className:"h-6 w-6"}),title:"Profile story",helper:"Ground your profile with context, voice, and proof-of-life shots."}),(0,l.jsxs)("div",{className:"space-y-5",children:[(0,l.jsxs)(K,{label:"City",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row",children:[l.jsx("input",{type:"text",value:e.city,onChange:e=>k(e.target.value),className:"flex-1 rounded-xl border-2 border-gray-200 px-4 py-3 focus:border-purple-500 focus:outline-none",placeholder:"Brooklyn, New York",autoComplete:"off"}),(0,l.jsxs)("button",{type:"button",onClick:()=>{if(!navigator.geolocation){b("Location services are not supported on this device.");return}if(!d){b("Mapbox token missing. Add NEXT_PUBLIC_MAPBOX_TOKEN and reload.");return}N(!0),navigator.geolocation.getCurrentPosition(async e=>{try{let{latitude:t,longitude:a,accuracy:r}=e.coords,l=new URL(`https://api.mapbox.com/geocoding/v5/mapbox.places/${a},${t}.json`);l.searchParams.set("access_token",d),l.searchParams.set("types","place,locality"),l.searchParams.set("limit","1");let s=await fetch(l.toString());if(!s.ok)throw Error("Reverse geocoding failed");let i=await s.json(),o=i.features?.[0];o?S(A(o),r??null):b("We could not determine a city for your location.")}catch(e){console.error("Geolocation reverse lookup failed",e),b("Unable to resolve your location at the moment.")}finally{N(!1)}},e=>{N(!1),b(e.message||"Unable to access your location.")},{enableHighAccuracy:!0,timeout:1e4})},disabled:f,className:"inline-flex items-center justify-center gap-2 rounded-xl border-2 border-gray-200 px-4 py-3 text-sm font-semibold text-gray-600 transition hover:border-purple-500 hover:text-purple-600 disabled:cursor-not-allowed disabled:opacity-60",children:[l.jsx(j.Z,{className:"h-4 w-4"}),f?"Locating…":"Use my location"]})]}),y&&l.jsx("p",{className:"text-sm text-rose-600",children:y}),!d&&l.jsx("p",{className:"text-sm text-amber-600",children:"Map search is offline until a Mapbox token is configured."})]}),m&&u.length>0&&l.jsx("ul",{className:"mt-2 max-h-56 overflow-y-auto rounded-2xl border border-gray-200 bg-white shadow-xl",children:u.map(e=>l.jsx("li",{children:(0,l.jsxs)("button",{type:"button",className:"flex w-full flex-col items-start gap-1 px-4 py-3 text-left hover:bg-purple-50",onClick:()=>S(e),children:[l.jsx("span",{className:"text-sm font-semibold text-gray-900",children:e.label}),l.jsx("span",{className:"text-xs text-gray-500",children:e.secondaryLabel})]})},e.id))}),h&&l.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Searching Mapbox…"})]}),l.jsx(K,{label:"Bio (min 20 characters)",children:l.jsx("textarea",{value:e.bio,onChange:e=>t("bio",e.target.value),className:"h-32 w-full rounded-xl border-2 border-gray-200 px-4 py-3 focus:border-purple-500 focus:outline-none",placeholder:"Share your story, quirks, or what lights you up."})}),l.jsx(K,{label:"Photos",children:(0,l.jsxs)("div",{className:"space-y-4",children:[e.photos.map((t,a)=>(0,l.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center",children:[(0,l.jsxs)("div",{className:"flex flex-1 items-center rounded-2xl border-2 border-dashed border-gray-200 px-4 py-3",children:[l.jsx(w.Z,{className:"mr-3 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"url",value:t,onChange:e=>r(a,e.target.value),className:"w-full bg-transparent focus:outline-none",placeholder:"https://images.lovedate.com/you.jpg"})]}),(0,l.jsxs)("label",{className:"flex w-full max-w-[160px] cursor-pointer items-center justify-center rounded-xl border border-gray-200 px-3 py-2 text-sm font-semibold text-gray-600 transition hover:border-purple-500 hover:text-purple-600",children:["Upload",l.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:e=>i(a,e.target.files?.[0]??null)})]}),e.photos.length>1&&l.jsx("button",{type:"button",onClick:()=>c(a),className:"rounded-xl border border-gray-200 px-3 py-2 text-sm text-gray-500 hover:border-rose-400 hover:text-rose-500",children:"Remove"}),t&&L(t)>460800&&l.jsx("p",{className:"mt-1 text-xs text-rose-600",children:"This image exceeds the 450 KB inline upload limit."})]},a)),e.photos.length<5&&l.jsx("button",{type:"button",onClick:o,className:"flex items-center gap-2 text-sm font-semibold text-purple-600",children:"+ Add another link"})]})})]})]},"story")},V=({data:e,onChange:t})=>(0,l.jsxs)(n.E.div,{initial:{opacity:0,x:40},animate:{opacity:1,x:0},exit:{opacity:0,x:-40},transition:{duration:.25},children:[l.jsx(G,{icon:l.jsx(N.Z,{className:"h-6 w-6"}),title:"Verification",helper:"Opt into live verification now or schedule it for later."}),l.jsx(K,{label:"Verification intent",children:l.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:[{value:"verify_now",label:"Verify now",helper:"Fast-lane into premium visibility."},{value:"verify_later",label:"Verify later",helper:"We’ll remind you after onboarding."}].map(a=>(0,l.jsxs)("button",{type:"button",onClick:()=>t("verificationIntent",a.value),className:`rounded-2xl border-2 px-4 py-4 text-left transition ${e.verificationIntent===a.value?"border-purple-600 bg-purple-50":"border-gray-200"}`,children:[l.jsx("p",{className:"text-base font-semibold text-gray-900",children:a.label}),l.jsx("p",{className:"text-sm text-gray-500",children:a.helper})]},a.value))})}),l.jsx("div",{className:"mt-6 rounded-2xl bg-gray-50 px-4 py-4 text-sm text-gray-600",children:(0,l.jsxs)("p",{className:"flex items-center gap-2",children:[l.jsx(N.Z,{className:"h-4 w-4 text-purple-600"}),"Verification unlocks deeper trust signals, feature access, and faster approvals."]})})]},"verification");function G({icon:e,title:t,helper:a}){return(0,l.jsxs)("div",{className:"mb-6 flex items-start gap-4",children:[l.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-purple-50 text-purple-600",children:e}),(0,l.jsxs)("div",{children:[l.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:t}),l.jsx("p",{className:"text-sm text-gray-500",children:a})]})]})}function K({label:e,icon:t,children:a}){return(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-900",children:[l.jsx("span",{className:"mb-2 block text-sm text-gray-600",children:e}),(0,l.jsxs)("div",{className:"relative",children:[t&&l.jsx("span",{className:"pointer-events-none absolute left-3 top-1/2 -translate-y-1/2",children:t}),a]})]})}function X({label:e,selected:t,onClick:a,multi:r,helper:s}){return(0,l.jsxs)("button",{type:"button",onClick:a,className:`rounded-2xl border-2 px-4 py-3 text-left text-sm font-semibold transition ${t?"border-purple-600 bg-purple-50 text-purple-700":"border-gray-200 text-gray-700"} ${r?"min-w-[140px]":"w-full"}`,children:[e,s&&l.jsx("p",{className:"mt-1 text-xs font-normal text-gray-500",children:s})]})}let Y=()=>(0,l.jsxs)("svg",{className:"h-4 w-4 text-gray-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M2 3h20"}),l.jsx("path",{d:"M2 8h20"}),l.jsx("path",{d:"M5 3v5"}),l.jsx("path",{d:"M19 3v5"}),l.jsx("rect",{x:"4",y:"11",width:"16",height:"10",rx:"2"})]}),q=(0,s.createContext)(null);function J({children:e}){let[t,a]=(0,s.useState)(!1),r=(0,s.useCallback)(()=>a(!0),[]),i=(0,s.useCallback)(()=>a(!1),[]);return l.jsx(P,{children:(0,l.jsxs)(q.Provider,{value:{openModal:r,closeModal:i},children:[e,l.jsx(U,{isOpen:t,onClose:i})]})})}function Q(){let e=(0,s.useContext)(q);if(!e)throw Error("useOnboardingModal must be used within an OnboardingModalProvider");return e}},38207:(e,t,a)=>{"use strict";a.d(t,{SignInModalProvider:()=>y,S:()=>b});var r=a(73227),l=a(23677),s=a(41043),i=a(66655),o=a(94725),n=a(4211),c=a(95189),d=a(77587),u=a(98813),p=a(20525),m=a(57099);let x={email:"",phone:"",password:"",mode:"email"};function h({isOpen:e,onClose:t}){let[a,h]=(0,l.useState)(x),[g,y]=(0,l.useState)(!1),[b,f]=(0,l.useState)(null),[v,j]=(0,l.useState)(null),w=(0,s.useRouter)(),N="email"===a.mode?n.Z:c.Z,C=(0,l.useMemo)(()=>"email"===a.mode?"Email address":"Phone number",[a.mode]),P="email"===a.mode?a.email:a.phone,k=P.trim().length>3&&a.password.length>=8&&!g,S=(e,t)=>{h(a=>({...a,[e]:t}))},M=e=>{h(t=>({...t,mode:e}))},O=async e=>{if(e.preventDefault(),k){y(!0),f(null);try{let e={email:"email"===a.mode?a.email.trim():void 0,phone:"phone"===a.mode?a.phone.trim():void 0,password:a.password},r=await fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!r.ok)throw Error((await r.json().catch(()=>null))?.message??"Invalid credentials.");let l=await r.json();j(`Welcome back, ${l.user.displayName}! Redirecting…`),setTimeout(()=>{j(null),t(),w.push(l.nextRoute??"/dashboard")},1100)}catch(e){f(e instanceof Error?e.message:"Unable to sign you in.")}finally{y(!1)}}};return r.jsx(i.M,{children:e&&(0,r.jsxs)(r.Fragment,{children:[r.jsx(o.E.div,{initial:{opacity:0},animate:{opacity:.6},exit:{opacity:0},className:"fixed inset-0 z-50 bg-ink-900/80 backdrop-blur",onClick:t}),r.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:r.jsx("div",{className:"flex min-h-screen items-center justify-center px-4 py-10",children:(0,r.jsxs)(o.E.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",duration:.4},className:"relative w-full max-w-md",onClick:e=>e.stopPropagation(),children:[r.jsx("button",{type:"button",onClick:t,className:"absolute -top-4 -right-4 flex h-11 w-11 items-center justify-center rounded-full bg-white shadow-lg transition hover:bg-ink-50","aria-label":"Close sign-in modal",children:r.jsx(d.Z,{className:"h-5 w-5 text-ink-700"})}),(0,r.jsxs)("div",{className:"rounded-3xl bg-white p-8 shadow-2xl",children:[(0,r.jsxs)("div",{className:"mb-6 text-center",children:[r.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-ink-500",children:"Lovedate"}),r.jsx("h2",{className:"mt-3 font-display text-3xl text-ink-900",children:"Sign in to continue"}),r.jsx("p",{className:"mt-2 text-sm text-ink-600",children:"Secure access to your trust dashboard."})]}),(0,r.jsxs)("form",{onSubmit:O,className:"space-y-5",children:[r.jsx("div",{className:"flex rounded-full bg-ink-50 p-1",children:["email","phone"].map(e=>r.jsx("button",{type:"button",onClick:()=>M(e),className:`flex-1 rounded-full px-4 py-2 text-sm font-medium transition ${a.mode===e?"bg-white text-ink-900 shadow-sm":"text-ink-500"}`,children:"email"===e?"Email":"Phone"},e))}),(0,r.jsxs)("label",{className:"block space-y-2",children:[r.jsx("span",{className:"text-sm font-medium text-ink-700",children:C}),(0,r.jsxs)("div",{className:"flex items-center gap-3 rounded-2xl border border-ink-200 px-4 py-3 focus-within:border-ink-900",children:[r.jsx(N,{className:"h-4 w-4 text-ink-400"}),r.jsx("input",{type:"email"===a.mode?"email":"tel",autoComplete:"email"===a.mode?"email":"tel",value:P,onChange:e=>S(a.mode,e.currentTarget.value),className:"w-full bg-transparent text-ink-900 outline-none",placeholder:"email"===a.mode?"you@example.com":"+1 (415) 555-0101"})]})]}),(0,r.jsxs)("label",{className:"block space-y-2",children:[r.jsx("span",{className:"text-sm font-medium text-ink-700",children:"Password"}),(0,r.jsxs)("div",{className:"flex items-center gap-3 rounded-2xl border border-ink-200 px-4 py-3 focus-within:border-ink-900",children:[r.jsx(u.Z,{className:"h-4 w-4 text-ink-400"}),r.jsx("input",{type:"password",autoComplete:"current-password",value:a.password,onChange:e=>S("password",e.currentTarget.value),className:"w-full bg-transparent text-ink-900 outline-none",placeholder:"At least 8 characters"})]})]}),b&&r.jsx("p",{className:"rounded-2xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-700","aria-live":"polite",children:b}),v&&(0,r.jsxs)("p",{className:"flex items-center gap-2 rounded-2xl border border-emerald-200 bg-emerald-50 px-4 py-3 text-sm text-emerald-700","aria-live":"polite",children:[r.jsx(p.Z,{className:"h-4 w-4"}),v]}),r.jsx("button",{type:"submit",disabled:!k,className:"flex w-full items-center justify-center gap-2 rounded-2xl bg-gradient-to-r from-purple-600 to-pink-600 py-3 text-white shadow-lg transition hover:shadow-xl disabled:cursor-not-allowed disabled:opacity-60",children:g?(0,r.jsxs)(r.Fragment,{children:[r.jsx(m.Z,{className:"h-4 w-4 animate-spin"}),"Signing in…"]}):"Sign in"})]})]})]})})})]})})}let g=(0,l.createContext)(null);function y({children:e}){let[t,a]=(0,l.useState)(!1),s=(0,l.useCallback)(()=>a(!0),[]),i=(0,l.useCallback)(()=>a(!1),[]);return(0,r.jsxs)(g.Provider,{value:{openModal:s,closeModal:i},children:[e,r.jsx(h,{isOpen:t,onClose:i})]})}function b(){let e=(0,l.useContext)(g);if(!e)throw Error("useSignInModal must be used within a SignInModalProvider");return e}},25757:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>b,metadata:()=>y});var r=a(99013),l=a(73706),s=a.n(l),i=a(47379),o=a.n(i);a(75556);var n=a(53189);let c=(0,n.createProxy)(String.raw`D:\amoravibe\apps\web\src\app\providers\OnboardingModalProvider.tsx`),{__esModule:d,$$typeof:u}=c;c.default;let p=(0,n.createProxy)(String.raw`D:\amoravibe\apps\web\src\app\providers\OnboardingModalProvider.tsx#OnboardingModalProvider`);(0,n.createProxy)(String.raw`D:\amoravibe\apps\web\src\app\providers\OnboardingModalProvider.tsx#useOnboardingModal`);let m=(0,n.createProxy)(String.raw`D:\amoravibe\apps\web\src\app\providers\SignInModalProvider.tsx`),{__esModule:x,$$typeof:h}=m;m.default;let g=(0,n.createProxy)(String.raw`D:\amoravibe\apps\web\src\app\providers\SignInModalProvider.tsx#SignInModalProvider`);(0,n.createProxy)(String.raw`D:\amoravibe\apps\web\src\app\providers\SignInModalProvider.tsx#useSignInModal`);let y={title:"Lovedate Trust Center",description:"Onboarding, verification, and safety tooling for the Lovedate platform"};function b({children:e}){return r.jsx("html",{lang:"en",children:r.jsx("body",{className:`${s().variable} ${o().variable}`,children:r.jsx(p,{children:r.jsx(g,{children:e})})})})}},75556:()=>{}};